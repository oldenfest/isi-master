-function(){"use strict";var f;var h=function(a){return"gwd-page"==a.tagName.toLowerCase()||"gwd-page"==a.getAttribute("is")},k=function(a){if(h(a))return a;for(;a&&9!=a.nodeType;)if((a=a.parentElement)&&h(a))return a;return null};function l(a,b){this.Aa=a;this.V=b}l.prototype.fetch=function(){var a=this.ta.bind(this),b=this.pa.bind(this);navigator.geolocation.getCurrentPosition(a,b)};l.prototype.ta=function(a){a=a.coords;this.Aa(a.latitude,a.longitude,a.accuracy)};l.prototype.pa=function(a){this.V(a.message)};var m=function(a,b,c){var d;c?(d=document.createEvent("CustomEvent"),d.initCustomEvent(a,!0,!0,c)):(d=document.createEvent("Event"),d.initEvent(a,!0,!0));b.dispatchEvent(d);return d},n=function(a,b){var c=function(d){a.removeEventListener("load",c);b(d)};a.addEventListener("load",c)};function p(a,b,c,d){this.u=a;this.p=null;this.T=c;this.ca=d;a=document.createElement("div");a.innerHTML='<div class="bg"><a class="dir"><div></div></a><div class="res"><div class="title"></div><div class="address"></div><div class="tel"><a href="#"></a></div></div><a class="close"><div></div></a></div>';a.className="ip";a.querySelector(".dir").addEventListener("click",this.qa.bind(this),!1);a.querySelector(".close").addEventListener("click",this.na.bind(this),!1);this.Ba=a.querySelector(".title");
this.Q=a.querySelector(".address");this.w=a.querySelector(".tel");this.o=this.w.firstChild;this.o.addEventListener("click",this.ma.bind(this));this.b=a;this.d();b.appendChild(a)}p.prototype.d=function(){this.b.classList.add("hidden")};p.prototype.ma=function(a){a.preventDefault();a=this.o.href;m("calllocation",this.u,{url:a}).detail.handled||window.open(a)};p.prototype.na=function(a){a.preventDefault();this.d();this.T()};p.prototype.qa=function(a){a.preventDefault();this.p&&this.ca(this.p)};function q(a){var b=document.createElement("div");b.innerHTML='<div class="loading"><div></div></div>';b.className="bg hidden";this.b=b;a.appendChild(this.b)}q.prototype.show=function(){this.b.classList.remove("hidden")};q.prototype.d=function(){this.b.classList.add("hidden")};function r(a,b,c,d){this.s=b;this.Z=c;t(this,d);a.appendChild(this.b)}
var t=function(a,b){var c=document.createElement("div");c.innerHTML='<div class="diag"><div class="title"></div><div class="btns"></div><form method="get"><input type="search" /></form></div>';var d=c.querySelector(".title");d.textContent=b.title;a.Ca=d;d=c.querySelector(".btns");a.R=d;a.s?(u(d,b.da,a.s),u(d,b.$,a.A.bind(a,b.ba))):d.classList.add("hidden");var e=c.querySelector("input");e.placeholder=b.aa;a.ha=e;d=c.querySelector("form");a.Y=d;d.addEventListener("submit",function(a){a.preventDefault();
this.Z(e.value)}.bind(a),!1);a.s&&d.classList.add("hidden");c.classList.add("bg");a.b=c},u=function(a,b,c){var d=document.createElement("a");d.textContent=b;d.addEventListener("click",function(a){a.preventDefault();c()},!1);d.href="#";a.appendChild(d)};r.prototype.d=function(){this.b.classList.add("hidden")};r.prototype.A=function(a){this.Ca.textContent=a;this.R.classList.add("hidden");this.Y.classList.remove("hidden");this.b.classList.remove("hidden");this.ha.focus()};function v(a){this.fa=a}v.prototype.search=function(a,b,c){(new google.visualization.Query(w(this,a,b))).send(function(a){if(a.isError()||a.hasWarning())a=[];else{a=a.getDataTable();for(var b=[],g=0;g<a.getNumberOfRows();++g)b.push({name:a.getValue(g,0),formatted_address:a.getValue(g,1),formatted_phone_number:a.getValue(g,2),geometry:{location:new google.maps.LatLng(a.getValue(g,3),a.getValue(g,4))}});a=b}c(a)})};
var w=function(a,b,c){b="LATLNG("+b.getCenter().toUrlValue()+")";return"https://www.google.com/fusiontables/gvizdata?tq="+encodeURIComponent("SELECT name, address, phone, latitude, longitude FROM "+a.fa+" ORDER BY ST_DISTANCE(latitude, "+b+") LIMIT "+c)};function x(a,b){this.za=a;for(var c=b.split("."),d=window,e=0;d&&e<c.length;e++)d=d[c[e]];this.m=d?0:2;this.n=[]}x.prototype.ra=function(){for(var a=this.m=0;a<this.n.length;a++)this.n[a]();this.n=[]};x.prototype.load=function(a){a&&(0==this.m?a():this.n.push(a));if(2==this.m){this.m=1;a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src=this.za;n(a,this.ra.bind(this));var b=document.getElementsByTagName("script")[0];b?b.parentNode.insertBefore(a,b):document.getElementsByTagName("head")[0].appendChild(a)}};var y=null,z=function(a,b,c){y||(y=new x("https://www.google.com/jsapi","google.load"));y.load(function(){google.load(a,b,c)})};function A(a,b){this.va=a;this.ua=new google.maps.places.PlacesService(b)}A.prototype.search=function(a,b,c){this.ua.textSearch({location:a.getCenter(),radius:3*a.getRadius(),query:this.va},function(a,b){c(b==google.maps.places.PlacesServiceStatus.OK?a:[])})};var C=function(a){a=a.trim();return window.Enabler?Enabler.getUrl(a):a};function D(a,b,c,d,e,g,B){this.u=a;this.a=null;this.wa=c;this.ka=d;this.la=e;this.xa=g;this.c=B;this.ia=B.limit;this.C=null;this.i=0;this.k=this.F=this.t=this.H=this.K=this.B=this.v=null;this.h=[];this.N=[];this.P=null;a=document.createElement("div");a.className="map";this.b=a;b.appendChild(a)}
var E=function(a,b){var c=document.createElement("img"),d=function(){c.removeEventListener("load",d,!1);c.removeEventListener("error",d,!1);c.removeEventListener("abort",d,!1);b()};c.addEventListener("load",d,!1);c.addEventListener("error",d,!1);c.addEventListener("abort",d,!1);c.src=C(a)};f=D.prototype;
f.U=function(){this.i--;if(0==this.i){var a=this.c,b,c;a.lat&&a.lng?(b=new google.maps.LatLng(a.lat,a.lng),c=a.zoom):(b=new google.maps.LatLng(0,0),c=1);b=new google.maps.Map(this.b,{center:b,zoom:c,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1});this.P=b.getBounds();google.maps.event.addListener(b,"dragend",this.oa.bind(this));google.maps.event.addListener(b,"click",this.sa.bind(this));c=C(this.c.L);this.v={url:c,size:new google.maps.Size(34,34),origin:new google.maps.Point(0,0)};this.B=
{url:c,size:new google.maps.Size(34,34),origin:new google.maps.Point(34,0)};this.K={url:c,size:new google.maps.Size(37,34),origin:new google.maps.Point(68,0),anchor:new google.maps.Point(10,34)};this.H={url:C(this.c.G),size:new google.maps.Size(18,18),anchor:new google.maps.Point(9,9)};this.C=a.q?new v(a.q):new A(a.query||"*",b);this.a=b;this.wa()}};f.oa=function(){this.k&&!this.k.getBounds().contains(this.a.getCenter())&&(this.l(),this.xa())};
f.l=function(){this.j&&(this.j.setIcon(this.v),this.j=null)};f.search=function(a){if(this.a){var b=this.c.radius,c=10-this.a.getZoom();0<c&&(b*=c);this.k=new google.maps.Circle({center:this.a.getCenter(),radius:b});this.C.search(this.k,this.ia,this.onSearchComplete_.bind(this,a))}};
f.onSearchComplete_=function(a,b){for(var c=0;c<this.h.length;c++)this.h[c].setMap(null),google.maps.event.clearInstanceListeners(this.h[c]);this.h.length=0;this.N=b;for(var d=this.a,c=0;c<b.length;c++){var e=new google.maps.Marker({position:b[c].geometry.location,map:d,icon:this.v,shadow:this.K});google.maps.event.addListener(e,"click",this.onMarkerClick_.bind(this,c));this.h.push(e)}d.fitBounds(this.k.getBounds());(c=0<b.length)&&(e=d.getBounds())&&!e.contains(b[0].geometry.location)&&(e.extend(b[0].geometry.location),
d.fitBounds(e));a(c)};f.sa=function(){this.l();this.ka()};f.onMarkerClick_=function(a){this.l();this.j=this.h[a];this.la(this.N[a],this.W.bind(this))};f.W=function(a){this.j.setIcon(this.B);this.a.panTo(this.j.getPosition());this.a.panBy(0,a)};f.ea=function(a,b,c,d){d==google.maps.GeocoderStatus.OK?(this.a.setCenter(c[0].geometry.location),this.a.fitBounds(c[0].geometry.viewport),a()):b()};var F=function(a,b,c){return a.hasAttribute(b)?parseFloat(a.getAttribute(b)):c},G=function(a,b,c){return a.hasAttribute(b)?a.getAttribute(b):c};
document.registerElement&&document.registerElement("gwd-map",{prototype:Object.create(HTMLElement.prototype,{createdCallback:{value:function(){this.a=null;this.I=this.J=!1;this.O=this.c=this.f=this.g=this.e=this.r=null},enumerable:!0},attachedCallback:{value:function(){if(!this.a){var a={X:G(this,"msg-geocode-failure","Your location could not be determined. Please enter a nearby zip code."),G:G(this,"gps-src","assets/location.png"),limit:F(this,"result-limit",20),ja:{title:G(this,"msg-start-position-prompt",
"How would you like us to get your position?"),da:G(this,"msg-gps-button-label","Use GPS"),$:G(this,"msg-manual-position-button-label","Enter zip code"),ba:G(this,"msg-manual-position-prompt","Enter your zip code"),aa:G(this,"msg-manual-position-placeholder","eg: 95113")},L:G(this,"marker-src","assets/marker_sprite.png"),Ha:G(this,"msg-no-results-found","No results found near you."),radius:F(this,"search-radius",4E4),M:this.hasAttribute("request-user-location")||!this.hasAttribute("start-latitude")||
!this.hasAttribute("start-longitude"),zoom:F(this,"start-zoom",16),ya:this.hasAttribute("show-location-bar"),Fa:this.hasAttribute("include-directions"),Ea:this.hasAttribute("include-click-to-call"),ga:this.hasAttribute("include-drape-image")};this.hasAttribute("query")&&(a.query=this.getAttribute("query"));this.hasAttribute("start-latitude")&&(a.lat=parseFloat(this.getAttribute("start-latitude")));this.hasAttribute("start-longitude")&&(a.lng=parseFloat(this.getAttribute("start-longitude")));this.hasAttribute("client-id")&&
(a.S=this.getAttribute("client-id"));this.hasAttribute("fusion-table-id")&&(a.q=this.getAttribute("fusion-table-id"));a.ya&&this.hasAttribute("location-bar-color")&&(a.Ga=this.getAttribute("location-bar-color"));a.ga&&this.hasAttribute("drape-image-source")&&(a.Da=this.getAttribute("drape-image-source"));var b=document.createElement("div");b.className="sizer";this.a=new D(this,b,this.onMapReady_.bind(this),this.maybeHideInfoPane_.bind(this),this.onMarkerClick_.bind(this),this.search_.bind(this),a);
var c=this.onGeolocationSuccess_.bind(this),d=this.onGeolocationError_.bind(this);this.r=navigator.geolocation?new l(c,d):null;this.g=new r(b,this.r&&this.onGeolocationSearch_.bind(this),this.onGeocodeSearch_.bind(this),a.ja);a.M||this.g.d();this.e=new q(b);this.c=a;this.appendChild(b);this.O=b}"function"!=typeof this.gwdLoad||"function"!=typeof this.gwdIsLoaded||this.gwdIsLoaded()||(b=(a=k(this))&&"function"==typeof a.gwdIsLoaded,(!a||b&&a.gwdIsLoaded())&&this.gwdLoad());a=this.a;a.a&&google.maps.event.trigger(a.a,
"resize")},enumerable:!0},gwdLoad:{value:function(){if(!this.I){this.I=!0;var a=this.a,b=a.U.bind(a);a.i=2;E(a.c.L,b);++a.i;E(a.c.G,b);var c=!!a.c.q;++a.i;var d=a.c.S;z("maps","3.13",{callback:b,other_params:"sensor=true"+(c?"":"&libraries=places")+(d?"&client="+d:"")});c&&(++a.i,z("visualization","1",{callback:b}));b()}},enumerable:!0},gwdIsLoaded:{value:function(){return this.J},enumerable:!0},onMapReady_:{value:function(){this.c.M||this.search_();this.classList.add("ready");this.J=!0;m("ready",
this)},enumerable:!1},onGeolocationSearch_:{value:function(){this.e.show();this.g.d();this.r.fetch()},enumerable:!1},onGeolocationSuccess_:{value:function(a,b,c){this.e.d();var d=this.a;d.a&&(a=new google.maps.LatLng(a,b),b=d.a,d.t=a,b.setCenter(a),c&&(d.F=new google.maps.Circle({center:a,radius:c,map:b,fillColor:"#a2d1f5",fillOpacity:.5,strokeWeight:0}),new google.maps.Marker({position:a,map:b,icon:d.H}),b.fitBounds(d.F.getBounds())));this.search_()},enumerable:!1},onGeolocationError_:{value:function(a){this.e.d();
this.g.A(a)},enumerable:!1},onGeocodeSearch_:{value:function(a){this.e.show();this.g.d();var b=this.a,c=this.search_.bind(this),d=this.onGeocodeError_.bind(this);b.a&&(b.D||(b.D=new google.maps.Geocoder),b.D.geocode({address:a,bounds:b.P},b.ea.bind(b,c,d)))},enumerable:!1},search_:{value:function(){this.e.show();this.a.search(this.onSearchComplete_.bind(this));this.maybeHideInfoPane_();m("mapopen",this)},enumerable:!1},onSearchComplete_:{value:function(a){this.e.d();a?m("resultsfound",this):(this.g.A(this.c.X),
m("resultsnotfound",this))},enumerable:!1},onGeocodeError_:{value:function(){this.onSearchComplete_(!1)},enumerable:!1},maybeHideInfoPane_:{value:function(){this.f&&this.f.d()},enumerable:!1},onMarkerClick_:{value:function(a,b){this.f||(this.f=new p(this,this.O,this.a.l.bind(this.a),this.onDirectionsSearch_.bind(this)));var c=this.f;c.p=a;c.Ba.textContent=a.name;var d=a.vicinity||a.formatted_address,d=d.replace(/, /,",\n");c.Q.textContent=d;a.formatted_phone_number?(c.w.classList.remove("hidden"),
c.o.textContent=a.formatted_phone_number,c.o.href="tel:"+a.formatted_phone_number.replace(/[^\d]/g,"")):c.w.classList.add("hidden");c.b.classList.remove("hidden");b(this.f.b.firstChild.offsetHeight/2);m("pinclick",this)},enumerable:!1},onDirectionsSearch_:{value:function(a){var b=this.a;b.a&&(a="http://maps.google.com/maps?saddr="+escape(b.t?b.t.toString():"")+"&daddr="+encodeURIComponent(a.formatted_address),m("getdirections",b.u,{url:a}).detail.handled||window.open(a))},enumerable:!1}})});}()
